{% extends "layout.html" %}

{% block insidehead %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/lightbox.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/common.css') }}">
{% endblock %}

{% block body %}

<div class="main">

  <nav id="sidebar">  
    <div class="sidebar-logo-area">
        <img class="logo-div" src="branding/logo.jpg">
        <button id="menuButtonClose" type="button" class="sidebar-close-btn init-hidden close" aria-label="Close">x</button>
    </div>
    <ul class="list-unstyled components">
        <li><a class="nav-link" href="home"><i class="fa fa-fw fa-home"></i> {{_('Home')}}</a></li>

        {% if info_data['is_authenticated'] == true and current_user.get_type()|int() == user_types['ADMIN']|int() %}
            <li><a class="nav-link" href="setup"><i class="fa fa-fw fa-keyboard-o"></i> {{_('Setup')}}</a></li>
            <li><a class="nav-link" href="profile"><i class="fa fa-fw fa-pencil"></i> {{_('Update')}}</a></li>
            <li><a class="nav-link" href="reservations"><i class="fa fa-fw fa-calendar"></i> {{_('Reservations')}}</a></li>
            <li><a class="nav-link" href="fines"><i class="fa fa-fw fa-dollar"></i> {{_('Fines')}}</a></li>
        {% elif info_data['is_authenticated'] == true %}
            <li><a class="nav-link" href="profile"><i class="fa fa-fw fa-pencil"></i> {{_('My Profile')}}</a></li>
            <li><a class="nav-link" href="reservations"><i class="fa fa-fw fa-calendar"></i> {{_('Reservations')}}</a></li>
        {% endif %}

        <li><a class="nav-link" href="announcs"><i class="fa fa-fw fa-bullhorn"></i> {{_('Announcements')}}</a></li>
        <li><a class="nav-link" href="docs"><i class="fa fa-fw fa-book"></i> {{_('Documents')}}</a></li>

        {% if info_data['is_authenticated'] == true and current_user.get_type() != 3 %}
            <li><a class="nav-link" href="upload" aria-selected="false"><i class="fa fa-fw fa-cog"></i> {{_('Maintenance')}}</a></li>
        {% endif %}

        <li class="active"><a class="nav-link" href="pics"><i class="fa fa-fw fa-picture-o"></i> {{_('Pictures')}}</a></li>
        <li><a class="nav-link" href="listings"><i class="fa fa-fw fa-list-ul"></i> {{_('Listings')}}</a></li>
        <li><a class="nav-link" href="about"><i class="fa fa-fw fa-info"></i> {{_('About')}}</a></li>
        {% include "info.html" %}
    </ul>
  </nav>

  <div class="content">

      {% include "mobile-menu.html" %}

      <div class="section-title" data-aos="zoom-out">
          <h2>{{_('Condominium Common Areas')}}</h2>
      </div>

      <div class="spacer"></div>

      {% if (pics is defined) and pics %}
          <div class="row">
            {% for pic in pics: %}
              <div class="col-lg-3 col-md-4 p-3 mb-4 bg-white center shadow rounded d-flex align-items-stretch">
                <div class="member-img">
                  <a class="example-image-link" href="pics/{{pic}}" data-lightbox="example-set" data-title="<-- click/tap image's left half to go backward; right half to go forward -->"><img class="img-fluid" src="pics/{{pic}}" alt=""/></a>
                </div>
              </div>
              <div style="margin: 1px;"></div>
            {% endfor %}
          </div>
      {% else %}
          <div class="no-item-msg">{{_('No condominium pictures yet. Ask the Admin to add pics.')}}</div>
      {% endif %}

      <div class="spacer"></div>
      <div class="spacer"></div>

      {% if info_data['is_authenticated'] == true and current_user.get_type()|int() == user_types['ADMIN']|int() %}
          <button class="btn btn-primary center" type="button" data-toggle="collapse" data-target="#add_new_pic_section" aria-expanded="false" aria-controls="collapseExample">
            {{_("Click to Add a New Picture")}}
          </button>

          <div class="app-container collapse" id="add_new_pic_section">
              <div class="upload-block-row">
                  <div class="upload-browse">
                      <input id="picture" type="file"/>
                      <button id="upload-button" onclick="uploadFileProgress('picture', 'picture', 'progressBar-pic')"> {{_("Upload a Common Area Picture")}}</button>
                      <progress id="progressBar-pic" value="0" max="100"/>
                  </div>
              </div>
          </div>
      {% endif %}

      <div class="spacer"></div>
      <div class="spacer"></div>
      <div class="spacer"></div>

      <div class="section-title" data-aos="zoom-out">
          <h2>{{_('Events')}}</h2>
      </div>

      {% if events is not none %}
          <div style="font-size: 16px;">
              <div>
                  <ul style="font-size: 18px;">
                  {% for key, event in events %}
                      <li>
                          <img src="event/eventpics/{{key}}/pics/{{event['cover_file']}}">
                          <a href="event/{{key}}">{{key}}</a>, date: {{event['date']}}
                          {% if info_data['is_authenticated'] == true and current_user.get_type()|int() == user_types['ADMIN']|int() %}
                              <button class="button" id="del-listing-button" onclick="deletePictureFiles('eventpics', '{{key}}')"><i class="fa fa-remove"></i>&nbsp;&nbsp;{{_("Delete This Event")}}</button>
                          {% endif  %}
                      </li>
                  {% endfor %}
                  </ul>
              </div>
          </div>
      {% else %}
          <div class="no-item-msg">{{_('No events yet.')}}</div>
      {% endif  %}

      {% if info_data['is_authenticated'] == true and current_user.get_type()|int() == user_types['ADMIN']|int() %}
          <button class="btn btn-primary center" type="button" data-toggle="collapse" data-target="#add_new_event_section" aria-expanded="false" aria-controls="collapseExample">
            {{_("Click to Add a New Event")}}
          </button>

          <div class="app-container collapse" id="add_new_event_section">
              <div class="spacer"></div>

              <div class="profile-block" style="font-size: 14px;">
                  <fieldset>
                      <legend>{{_('Event Info')}}</legend>
                      <label for="title">{{_('Title')}}:</label>
                      <input class="title-input" type="text" id="title" name="title">
                      <label class="separator-spacer"></label>
                      <label for="event_date">{{_('Date')}}:</label>
                      <input class="date-input" type="date" id="event_date" name="event_date">
                  </fieldset>
                  <div class="spacer"></div>
                  <fieldset>
                      <legend>{{_('Pictures')}}</legend>
                      <div>
                          <label for="files_cntrl" class="button larger-button"><i class="fa fa-folder-o"></i>&nbsp;&nbsp;{{_('Choose the Folder Where Your Pictures Are')}}</label>
                          <input id="files_cntrl" type="file" style="display: none" title="Click to Select a Folder" webkitdirectory directory multiple="false"/>
                      </div>
                      <div>
                          <fieldset>
                              <legend>{{_('Picture Files')}}</legend>
                              <div class="selected-files" id="selectedFiles"></div>
                          </fieldset>
                      </div>
                  </fieldset>
                  <div class="spacer"></div>
                  <div class="spacer"></div>
                  <div class="center">
                      <button class="button larger-button" id="upload_button" onclick="uploadPictureFiles('event_picture', 'files_cntrl', 'progress_bar')" disabled>
                      <i class="fa fa-upload"></i>&nbsp;&nbsp;{{_('Upload pictures & Create this new event')}}</button>
                      <progress id="progress_bar" value="0" max="100"/>
                  </div>
              </div>

          </div> <!-- closes app-container -->
      {% endif %}

  </div> <!-- closes content -->

</div> <!-- close main -->

{% include "hidden_fields.html" %}
{% endblock %}

{% block afterbody %}
   <script src="{{ url_for('static', filename='js/lightbox-plus-jquery.min.js') }}"></script>
   <script src="{{ url_for('static', filename='js/pics.js') }}"></script>
{% endblock %}

